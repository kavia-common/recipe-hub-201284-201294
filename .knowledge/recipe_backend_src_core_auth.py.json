{"is_source_file": true, "format": "Python", "description": "This file provides authentication utilities for a FastAPI application, including password hashing, JWT creation and decoding, current user retrieval, and email normalization.", "external_files": ["src.core.config", "src.core.db", "src.domain.users.models"], "external_methods": ["get_settings", "get_db_session"], "published": ["verify_password", "hash_password", "create_access_token", "create_refresh_token", "decode_access_token", "decode_refresh_token", "get_current_user", "normalize_email"], "classes": [{"name": "CurrentUser", "description": "Represents an authenticated user with an ID and optional email."}], "methods": [{"name": "datetime _utcnow()", "description": "Returns the current UTC datetime.", "scope": "", "scopeKind": ""}, {"name": "str _normalize_email(email: str)", "description": "Strips and lowercases an email address for normalization.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(*, subject: str, email: str, expires_minutes: int)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str create_refresh_token(*, subject: str, email: str, expires_minutes: int)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dict[str,Any] decode_access_token(token: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dict[str,Any] decode_refresh_token(token: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "CurrentUser get_current_user( token: str = Depends(oauth2_scheme), db: AsyncSession = Depends(get_db_session), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str hash_password(password: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str normalize_email(email: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool verify_password(plain_password: str, hashed_password: str)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "select", "jwtError", "Depends", "get_db_session", "select", "User"], "search-terms": ["JWT authentication", "FastAPI OAuth2", "Password hashing", "JWT token creation", "Current user extraction"], "state": 2, "file_id": 8, "knowledge_revision": 35, "git_revision": "b55b358a3b37510c4064a9cb2515e299ebbe655c", "revision_history": [{"25": "b55b358a3b37510c4064a9cb2515e299ebbe655c"}, {"35": "b55b358a3b37510c4064a9cb2515e299ebbe655c"}], "ctags": [{"_type": "tag", "name": "CurrentUser", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^class CurrentUser:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_normalize_email", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def _normalize_email(email: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(email: str)"}, {"_type": "tag", "name": "_utcnow", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def _utcnow() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def create_access_token(*, subject: str, email: str, expires_minutes: int) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*, subject: str, email: str, expires_minutes: int)"}, {"_type": "tag", "name": "create_refresh_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def create_refresh_token(*, subject: str, email: str, expires_minutes: int) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*, subject: str, email: str, expires_minutes: int)"}, {"_type": "tag", "name": "decode_access_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def decode_access_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "decode_refresh_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def decode_refresh_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^    email: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "CurrentUser", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^async def get_current_user($/", "language": "Python", "typeref": "typename:CurrentUser", "kind": "function", "signature": "( token: str = Depends(oauth2_scheme), db: AsyncSession = Depends(get_db_session), )"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "normalize_email", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def normalize_email(email: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(email: str)"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "pwd_context", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def verify_password(plain_password: str, hashed_password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, hashed_password: str)"}], "hash": "483fd622e3eb71c865fc0f8ed89cf791", "format-version": 4, "code-base-name": "recipe_backend", "filename": "recipe_backend/src/core/auth.py", "fields": [{"name": "Optional[str] email", "scope": "CurrentUser", "scopeKind": "class", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}]}