{"is_source_file": true, "format": "Python", "description": "This is a source code file for the authentication module in a FastAPI-based web application. It manages user authentication via JWT tokens, including password hashing, token creation, token decoding, and retrieving the current user from an access token.", "external_files": ["src.core.config", "src.core.db", "src.domain.users.models"], "external_methods": ["get_settings", "get_db_session", "User"], "published": ["get_current_user", "normalize_email"], "classes": [{"name": "CurrentUser", "description": "Represents the authenticated user extracted from the request, containing user ID and optional email."}], "methods": [{"name": "datetime _utcnow()", "description": "Returns the current UTC datetime.", "scope": "", "scopeKind": ""}, {"name": "str _normalize_email(email: str)", "description": "Normalizes email by trimming whitespace and converting to lowercase.", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(plain_password: str, hashed_password: str)", "description": "Verifies a plaintext password against a hashed password using bcrypt.", "scope": "", "scopeKind": ""}, {"name": "str hash_password(password: str)", "description": "Generates a bcrypt hash from a plaintext password.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(*, subject: str, email: str, expires_minutes: int)", "description": "Creates a signed JWT access token with user subject, email, and expiration.", "scope": "", "scopeKind": ""}, {"name": "str create_refresh_token(*, subject: str, email: str, expires_minutes: int)", "description": "Creates a signed JWT refresh token with user subject, email, and expiration.", "scope": "", "scopeKind": ""}, {"name": "dict[str,Any] decode_access_token(token: str)", "description": "Decodes and validates a JWT access token.", "scope": "", "scopeKind": ""}, {"name": "dict[str,Any] decode_refresh_token(token: str)", "description": "Decodes and validates a JWT refresh token.", "scope": "", "scopeKind": ""}, {"name": "CurrentUser get_current_user( token: str = Depends(oauth2_scheme), db: AsyncSession = Depends(get_db_session), )", "description": "Asynchronously retrieves the current user based on the access token, validating token and user status.", "scope": "", "scopeKind": ""}, {"name": "str normalize_email(email: str)", "description": "Public function to normalize email string.", "scope": "", "scopeKind": ""}], "calls": ["get_settings", "get_db_session", "jwt.encode", "jwt.decode", "select", "User.id", "User.email", "result.scalar_one_or_none"], "search-terms": ["JWT authentication", "FastAPI security", "OAuth2PasswordBearer", "JWTToken creation", "Password hashing", "decode JWT", "current user retrieval"], "state": 2, "file_id": 8, "knowledge_revision": 39, "git_revision": "2db7f072f7fdaa35ab1e2f48442d9d8b31f56f9f", "revision_history": [{"25": "b55b358a3b37510c4064a9cb2515e299ebbe655c"}, {"35": "b55b358a3b37510c4064a9cb2515e299ebbe655c"}, {"39": "2db7f072f7fdaa35ab1e2f48442d9d8b31f56f9f"}], "ctags": [{"_type": "tag", "name": "CurrentUser", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^class CurrentUser:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_normalize_email", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def _normalize_email(email: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(email: str)"}, {"_type": "tag", "name": "_utcnow", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def _utcnow() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def create_access_token(*, subject: str, email: str, expires_minutes: int) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*, subject: str, email: str, expires_minutes: int)"}, {"_type": "tag", "name": "create_refresh_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def create_refresh_token(*, subject: str, email: str, expires_minutes: int) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*, subject: str, email: str, expires_minutes: int)"}, {"_type": "tag", "name": "decode_access_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def decode_access_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "decode_refresh_token", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def decode_refresh_token(token: str) -> dict[str, Any]:$/", "language": "Python", "typeref": "typename:dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^    email: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "CurrentUser", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^async def get_current_user($/", "language": "Python", "typeref": "typename:CurrentUser", "kind": "function", "signature": "( token: str = Depends(oauth2_scheme), db: AsyncSession = Depends(get_db_session), )"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "normalize_email", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def normalize_email(email: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(email: str)"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "pwd_context", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/recipe-hub-201284-201294/recipe_backend/src/core/auth.py", "pattern": "/^def verify_password(plain_password: str, hashed_password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, hashed_password: str)"}], "hash": "26b06fbe8a0d98f1d566144e4509a3ea", "format-version": 4, "code-base-name": "recipe_backend", "filename": "recipe_backend/src/core/auth.py", "fields": [{"name": "Optional[str] email", "scope": "CurrentUser", "scopeKind": "class", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}]}